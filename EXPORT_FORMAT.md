# 📤 导出格式优化

## 🎯 优化内容

### 新增导出信息

1. **地址信息** ✅
   - 显示完整地址（城市、区县、街道）
   - 包含经纬度坐标
   - 显示定位精度

2. **音频标记** ✅
   - 标记包含音频的记录
   - 显示音频时长

3. **统计信息** ✅
   - 包含位置的记录数
   - 包含音频的记录数

---

## 📝 导出格式示例

### 完整示例

```markdown
# 生活记录

## 2025-01-14 (今天)

- 14:30 今天下午去了咖啡馆，点了一杯拿铁 🎵[15秒]
  📍 深圳市, 南山区, 科技园南路 (22.534567, 113.945678) [精度: 15m]

- 12:00 午餐吃了很棒的日料
  📍 深圳市, 福田区, 华强北路 (22.543210, 113.987654) [精度: 20m]

- 09:00 早上起床，天气不错

## 2025-01-13 (昨天)

- 18:00 晚上跑步5公里 🎵[30秒]
  📍 深圳市, 南山区, 深圳湾公园 (22.512345, 113.912345) [精度: 10m]

- 10:00 周末去爬山了
  📍 坐标: (22.498765, 114.123456) [精度: 50m]

---

**导出统计**

- 导出时间：2025-01-14 14:35:22
- 记录条数：5
- 包含位置：4 条
- 包含音频：2 条
- 时间范围：全部
```

---

## 🎨 格式说明

### 1. 基本记录格式

```markdown
- [时间] [内容] [音频标记]
  📍 [地址] [坐标] [精度]
```

**示例：**
```markdown
- 14:30 去咖啡馆喝咖啡 🎵[15秒]
  📍 深圳市, 南山区, 科技园南路 (22.534567, 113.945678) [精度: 15m]
```

---

### 2. 地址信息格式

#### 完整地址
```markdown
📍 城市, 区县, 街道 (纬度, 经度) [精度: Xm]
```

**示例：**
```markdown
📍 深圳市, 南山区, 科技园南路 (22.534567, 113.945678) [精度: 15m]
```

#### 仅坐标（无地址）
```markdown
📍 坐标: (纬度, 经度) [精度: Xm]
```

**示例：**
```markdown
📍 坐标: (22.498765, 114.123456) [精度: 50m]
```

---

### 3. 坐标精度

经纬度精确到 **6位小数**：
- 纬度：`22.534567`（精度约 0.11 米）
- 经度：`113.945678`（精度约 0.11 米）

**6位小数的意义：**
- 1位小数 ≈ 11.1 km
- 2位小数 ≈ 1.1 km
- 3位小数 ≈ 111 m
- 4位小数 ≈ 11.1 m
- 5位小数 ≈ 1.1 m
- **6位小数 ≈ 0.11 m** ⭐（厘米级精度）

---

### 4. 音频标记

```markdown
🎵[时长秒]
```

**示例：**
```markdown
- 14:30 今天下午去了咖啡馆 🎵[15秒]
```

---

### 5. 统计信息

```markdown
**导出统计**

- 导出时间：YYYY-MM-DD HH:mm:ss
- 记录条数：X 条
- 包含位置：X 条
- 包含音频：X 条
- 时间范围：[今天|最近7天|最近30天|全部]
```

---

## 📊 导出数据结构

### 地址信息层级

```
Location {
  ├─ 完整地址 (address)
  ├─ 结构化地址
  │  ├─ 国家 (country)
  │  ├─ 省份 (province)
  │  ├─ 城市 (city) ⭐
  │  ├─ 区县 (district) ⭐
  │  └─ 街道 (street) ⭐
  ├─ GPS 坐标
  │  ├─ 纬度 (latitude) ⭐
  │  └─ 经度 (longitude) ⭐
  └─ 精度信息
     ├─ 水平精度 (accuracy) ⭐
     ├─ 海拔 (altitude)
     ├─ 海拔精度 (altitudeAccuracy)
     ├─ 方向 (heading)
     └─ 速度 (speed)
}
```

**⭐ 标记的字段会包含在导出中**

---

## 🔄 导出逻辑

### 地址格式化逻辑

```typescript
function formatLocation(location) {
  // 1. 优先使用结构化地址
  if (location.city || location.district || location.street) {
    return `城市, 区县, 街道 (纬度, 经度) [精度: Xm]`;
  }
  
  // 2. 次选完整地址
  if (location.address) {
    return `完整地址 (纬度, 经度) [精度: Xm]`;
  }
  
  // 3. 最后仅显示坐标
  return `坐标: (纬度, 经度) [精度: Xm]`;
}
```

---

## 🎯 使用场景

### 1. 导出给 AI 分析

```markdown
# 生活记录

## 2025-01-14 (今天)

- 14:30 去咖啡馆写代码 🎵[15秒]
  📍 深圳市, 南山区, 科技园南路 (22.534567, 113.945678) [精度: 15m]

- 12:00 午餐吃日料
  📍 深圳市, 福田区, 华强北路 (22.543210, 113.987654) [精度: 20m]
```

**AI 可以分析：**
- 活动地点分布
- 地理位置偏好
- 移动轨迹
- 音频记录时长统计

---

### 2. 个人归档

导出的 Markdown 文件可以：
- 长期保存
- 搜索查询
- 地图标注
- 数据分析

---

### 3. 地理信息提取

通过经纬度坐标，可以：
- 在地图上标注
- 计算距离
- 分析路线
- 可视化轨迹

---

## 📍 坐标格式

### 标准格式

```
(纬度, 经度)
```

**示例：**
```
(22.534567, 113.945678)
```

### 可以直接使用的场景

1. **Google Maps**
   ```
   https://www.google.com/maps?q=22.534567,113.945678
   ```

2. **高德地图**
   ```
   https://www.amap.com/search?query=22.534567,113.945678
   ```

3. **百度地图**
   ```
   需要转换坐标系统（WGS84 → BD09）
   ```

---

## 🎨 Markdown 渲染效果

### 在支持 Markdown 的编辑器中

**原始文本：**
```markdown
- 14:30 去咖啡馆写代码 🎵[15秒]
  📍 深圳市, 南山区, 科技园南路 (22.534567, 113.945678) [精度: 15m]
```

**渲染效果：**
- 14:30 去咖啡馆写代码 🎵[15秒]
  📍 深圳市, 南山区, 科技园南路 (22.534567, 113.945678) [精度: 15m]

**视觉层次：**
- 主内容在第一行
- 地址信息缩进，视觉上是附加信息
- 图标（📍 🎵）提供视觉引导

---

## 📊 统计信息价值

### 导出统计示例

```markdown
**导出统计**

- 导出时间：2025-01-14 14:35:22
- 记录条数：42
- 包含位置：35 条
- 包含音频：12 条
- 时间范围：最近30天
```

**可以快速了解：**
- 记录的完整性（位置覆盖率：83%）
- 音频使用频率（28%）
- 数据的时间范围

---

## 🚀 使用方式

### 1. 导出全部记录

```
① 点击"导出记录"按钮
② 选择"全部"时间范围
③ 点击"复制"或"下载文件"
```

**效果：**
- 所有记录按日期分组
- 包含地址的记录显示完整位置信息
- 包含音频的记录显示时长标记

---

### 2. 导出特定时间范围

```
① 点击"导出记录"按钮
② 选择时间范围：
   - 今天
   - 最近7天
   - 最近30天
③ 点击"复制"或"下载文件"
```

**效果：**
- 仅导出指定时间范围的记录
- 统计信息自动更新

---

## 📁 文件格式

### 文件命名

```
生活记录_YYYY-MM-DD.md
```

**示例：**
```
生活记录_2025-01-14.md
```

### 文件编码

```
UTF-8 (无 BOM)
```

### MIME 类型

```
text/markdown;charset=utf-8
```

---

## 🔍 技术细节

### 地址格式化函数

```typescript
function formatLocation(location: Record['location']): string {
  if (!location) return '';
  
  const parts: string[] = [];
  
  // 构建地址字符串
  if (location.city || location.district || location.street) {
    if (location.city) parts.push(location.city);
    if (location.district) parts.push(location.district);
    if (location.street) parts.push(location.street);
  } else if (location.address) {
    parts.push(location.address);
  }
  
  const addressStr = parts.length > 0 ? parts.join(', ') : '';
  
  // 添加经纬度元信息（精确到6位小数）
  const lat = location.latitude.toFixed(6);
  const lng = location.longitude.toFixed(6);
  const coords = `(${lat}, ${lng})`;
  
  // 如果有精度信息，也包含进来
  let accuracyStr = '';
  if (location.accuracy) {
    accuracyStr = ` [精度: ${location.accuracy.toFixed(0)}m]`;
  }
  
  return addressStr 
    ? `\n  📍 ${addressStr} ${coords}${accuracyStr}`
    : `\n  📍 坐标: ${coords}${accuracyStr}`;
}
```

---

## ✅ 优化效果

### 优化前

```markdown
- 14:30 去咖啡馆写代码
```

**问题：**
- ❌ 没有地理位置信息
- ❌ 无法知道在哪里
- ❌ 不含音频时长

---

### 优化后

```markdown
- 14:30 去咖啡馆写代码 🎵[15秒]
  📍 深圳市, 南山区, 科技园南路 (22.534567, 113.945678) [精度: 15m]
```

**改进：**
- ✅ 包含完整地址
- ✅ 包含精确坐标（厘米级）
- ✅ 显示定位精度
- ✅ 标记音频时长
- ✅ 视觉层次清晰

---

## 🎯 最佳实践

### 1. 导出前检查

- 确保重要记录已保存位置信息
- 检查音频是否正常录制

### 2. 定期导出

建议：
- **每周导出一次**（最近7天）
- **每月导出一次**（最近30天）
- **重要时刻即时导出**

### 3. 多格式备份

- 复制到笔记软件（如 Notion、Obsidian）
- 下载为 Markdown 文件
- 导入到 AI 对话工具（如 ChatGPT）

---

## 🎉 总结

### 导出功能特点

1. **完整的地理信息** ✅
   - 结构化地址
   - 精确坐标（厘米级）
   - 定位精度

2. **丰富的元数据** ✅
   - 音频时长标记
   - 统计信息
   - 时间范围

3. **清晰的格式** ✅
   - Markdown 标准格式
   - 视觉层次分明
   - 易于阅读和处理

4. **灵活的导出** ✅
   - 多种时间范围
   - 复制或下载
   - UTF-8 编码

---

**现在，导出的数据包含完整的地理位置和经纬度信息，适合各种分析和归档场景！** 📤✨

