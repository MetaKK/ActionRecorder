# åç«¯æ¶æ„å®æ–½æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

æˆ‘å·²ç»ä¸ºä½ çš„ç”Ÿæ´»è®°å½•åº”ç”¨è®¾è®¡å¹¶å®ç°äº†å®Œæ•´çš„åç«¯æ¶æ„ï¼ŒåŒ…æ‹¬æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½çš„ä»£ç ã€æ–‡æ¡£å’Œéƒ¨ç½²æŒ‡å—ã€‚

---

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶ç»“æ„

```
é¡¹ç›®æ ¹ç›®å½•/
â”‚
â”œâ”€â”€ BACKEND_ARCHITECTURE.md          # æ ¸å¿ƒæ¶æ„è®¾è®¡æ–‡æ¡£ï¼ˆ37é¡µï¼‰
â”œâ”€â”€ QUICK_START.md                   # 5åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨æŒ‡å—
â”œâ”€â”€ BACKEND_IMPLEMENTATION_SUMMARY.md # æœ¬æ–‡ä»¶ï¼ˆæ€»ç»“ï¼‰
â”‚
â”œâ”€â”€ backend/                          # åç«¯æœåŠ¡æ ¹ç›®å½•
â”‚   â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–å’Œè„šæœ¬
â”‚   â”œâ”€â”€ tsconfig.json                 # TypeScript é…ç½®
â”‚   â”œâ”€â”€ .env.example                  # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚   â”œâ”€â”€ README.md                     # åç«¯ README
â”‚   â”‚
â”‚   â”œâ”€â”€ prisma/                       # æ•°æ®åº“å±‚
â”‚   â”‚   â””â”€â”€ schema.prisma             # æ•°æ®åº“ Schemaï¼ˆ7å¼ è¡¨ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”‚   â”œâ”€â”€ server.ts                 # æœåŠ¡å™¨å…¥å£æ–‡ä»¶
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ middleware/               # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.middleware.ts    # JWT è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ratelimit.middleware.ts # Redis é™æµä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ error.middleware.ts   # é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ notfound.middleware.ts # 404 å¤„ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ routes/                   # è·¯ç”±å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.routes.ts        # è®¤è¯è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ record.routes.ts      # ç”Ÿæ´»è®°å½•è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ diary.routes.ts       # AIæ—¥è®°è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ media.routes.ts       # åª’ä½“ä¸Šä¼ è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ sync.routes.ts        # æ•°æ®åŒæ­¥è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ ai.routes.ts          # AIä»£ç†è·¯ç”±
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ controllers/              # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts    # è®¤è¯é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ record.controller.ts  # è®°å½•CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ diary.controller.ts   # æ—¥è®°CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ media.controller.ts   # åª’ä½“å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ sync.controller.ts    # åŒæ­¥é€»è¾‘
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/                 # æœåŠ¡å±‚
â”‚   â”‚   â”‚   â””â”€â”€ storage.service.ts    # Cloudflare R2 å­˜å‚¨æœåŠ¡
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ database.ts           # Prisma å®¢æˆ·ç«¯
â”‚   â”‚       â”œâ”€â”€ logger.ts             # æ—¥å¿—å·¥å…·
â”‚   â”‚       â””â”€â”€ errors.ts             # è‡ªå®šä¹‰é”™è¯¯ç±»
â”‚   â”‚
â”‚   â””â”€â”€ docs/                         # æ–‡æ¡£ç›®å½•
â”‚       â””â”€â”€ DEPLOYMENT.md             # è¯¦ç»†éƒ¨ç½²æŒ‡å—
â”‚
â””â”€â”€ tools/                            # å·¥å…·è„šæœ¬
    â””â”€â”€ migrate-to-backend.ts         # æ•°æ®è¿ç§»å·¥å…·
```

**æ€»è®¡**: 30+ ä¸ªæ–‡ä»¶ï¼Œçº¦ 5000+ è¡Œä»£ç 

---

## ğŸ—ï¸ æ¶æ„ç‰¹ç‚¹

### 1. **åˆ†å±‚æ¶æ„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å‰ç«¯ (Next.js)               â”‚
â”‚  React + TypeScript + IndexedDB     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTPS + JWT
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         APIç½‘å…³å±‚ (Express)          â”‚
â”‚  è®¤è¯ã€é™æµã€æ—¥å¿—ã€é”™è¯¯å¤„ç†           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚        â”‚        â”‚
â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”â”Œâ”€â”€â–¼â”€â”€â”â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚ ä¸šåŠ¡å±‚   â”‚â”‚AIä»£ç†â”‚â”‚åª’ä½“æœåŠ¡ â”‚
â”‚ CRUD    â”‚â”‚     â”‚â”‚ä¸Šä¼ /CDN â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”˜â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚      â”‚       â”‚
â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚      æ•°æ®æŒä¹…å±‚            â”‚
â”‚ PostgreSQL + R2 + Redis   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. **æŠ€æœ¯æ ˆ**

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **è¿è¡Œæ—¶** | Node.js 20+ | ç°ä»£ ES2022 ç‰¹æ€§ |
| **æ¡†æ¶** | Express 4 | æˆç†Ÿç¨³å®šçš„ Node.js æ¡†æ¶ |
| **è¯­è¨€** | TypeScript 5 | ç±»å‹å®‰å…¨ |
| **æ•°æ®åº“** | PostgreSQL | å…³ç³»å‹æ•°æ®åº“ |
| **ORM** | Prisma 6 | ç±»å‹å®‰å…¨çš„ ORM |
| **å­˜å‚¨** | Cloudflare R2 | S3 å…¼å®¹å¯¹è±¡å­˜å‚¨ |
| **ç¼“å­˜** | Redis (Upstash) | é™æµå’Œä¼šè¯ |
| **è®¤è¯** | JWT | æ— çŠ¶æ€è®¤è¯ |
| **éªŒè¯** | Zod | Schema éªŒè¯ |

### 3. **æ ¸å¿ƒåŠŸèƒ½**

#### âœ… ç”¨æˆ·ç³»ç»Ÿ
- é‚®ç®±æ³¨å†Œ/ç™»å½•
- JWT Token è®¤è¯
- ç”¨æˆ·ç­‰çº§ç®¡ç†ï¼ˆFree/Premium/Enterpriseï¼‰
- å¯†ç ä¿®æ”¹ã€ä¸ªäººèµ„æ–™æ›´æ–°

#### âœ… ç”Ÿæ´»è®°å½•
- CRUD æ“ä½œï¼ˆåˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤ï¼‰
- æ”¯æŒä½ç½®ä¿¡æ¯ï¼ˆGPSåæ ‡ + åœ°å€ï¼‰
- éŸ³é¢‘å½•åˆ¶ï¼ˆURL å­˜å‚¨ï¼‰
- å›¾ç‰‡/è§†é¢‘å…³è”
- åˆ†é¡µæŸ¥è¯¢ã€æ—¥æœŸèŒƒå›´ç­›é€‰
- æ‰¹é‡å¯¼å…¥ï¼ˆæ•°æ®è¿ç§»ï¼‰

#### âœ… AIæ—¥è®°
- ä¿å­˜ AI ç”Ÿæˆçš„æ—¥è®°
- æ”¯æŒå¤šç§æ—¥è®°ç±»å‹ï¼ˆè‡ªåŠ¨/æ‰‹åŠ¨ï¼‰
- æƒ…ç»ªæ ‡ç­¾ã€å­—æ•°ç»Ÿè®¡
- æ—¥è®°ç½®é¡¶ã€è½¯åˆ é™¤
- æœç´¢å’Œç»Ÿè®¡åŠŸèƒ½

#### âœ… åª’ä½“ç®¡ç†
- å›¾ç‰‡/è§†é¢‘ä¸Šä¼ åˆ° Cloudflare R2
- è‡ªåŠ¨ç”Ÿæˆç¼©ç•¥å›¾ï¼ˆå›¾ç‰‡ï¼‰
- æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ 
- é¢„ç­¾å URLï¼ˆå¤§æ–‡ä»¶ä¸Šä¼ ï¼‰
- CDN åŠ é€Ÿåˆ†å‘

#### âœ… æ•°æ®åŒæ­¥
- å¢é‡åŒæ­¥ï¼ˆåªåŒæ­¥å˜æ›´ï¼‰
- å†²çªæ£€æµ‹ï¼ˆLast Write Winsï¼‰
- æ‰¹é‡æ¨é€/æ‹‰å–
- åŒæ­¥çŠ¶æ€æŸ¥è¯¢

#### âœ… å®‰å…¨ç‰¹æ€§
- Helmet.js å®‰å…¨å¤´
- CORS è·¨åŸŸé…ç½®
- JWT è¿‡æœŸéªŒè¯
- Redis é™æµä¿æŠ¤
- è¾“å…¥éªŒè¯ï¼ˆZodï¼‰
- SQL æ³¨å…¥é˜²æŠ¤ï¼ˆPrisma ORMï¼‰
- å¯†ç å“ˆå¸Œï¼ˆbcryptï¼‰

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### 7å¼ æ ¸å¿ƒè¡¨

```sql
users           -- ç”¨æˆ·è¡¨
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ email (UNIQUE)
â”œâ”€â”€ passwordHash
â”œâ”€â”€ tier (FREE/PREMIUM/ENTERPRISE)
â””â”€â”€ timestamps

records         -- ç”Ÿæ´»è®°å½•è¡¨
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ userId (FK â†’ users)
â”œâ”€â”€ content (TEXT)
â”œâ”€â”€ location (JSONB)
â”œâ”€â”€ audioUrl, audioDuration
â”œâ”€â”€ timestamp
â””â”€â”€ timestamps

diaries         -- AIæ—¥è®°è¡¨
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ userId (FK â†’ users)
â”œâ”€â”€ date (DATE)
â”œâ”€â”€ diaryData (JSONB) -- å®Œæ•´ Diary å¯¹è±¡
â”œâ”€â”€ mood, wordCount, type
â”œâ”€â”€ isPinned, isDeleted
â””â”€â”€ timestamps

media           -- åª’ä½“æ–‡ä»¶è¡¨
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ userId (FK â†’ users)
â”œâ”€â”€ type (IMAGE/VIDEO)
â”œâ”€â”€ url, thumbnailUrl
â”œâ”€â”€ width, height, sizeBytes
â””â”€â”€ timestamps

record_media    -- è®°å½•-åª’ä½“å…³è”è¡¨ï¼ˆå¤šå¯¹å¤šï¼‰
â”œâ”€â”€ recordId (FK â†’ records)
â”œâ”€â”€ mediaId (FK â†’ media)
â””â”€â”€ displayOrder

chat_sessions   -- AIèŠå¤©ä¼šè¯è¡¨
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ userId (FK â†’ users)
â”œâ”€â”€ model, messages (JSONB)
â””â”€â”€ timestamps

api_usage       -- APIä½¿ç”¨ç»Ÿè®¡ï¼ˆè®¡è´¹ï¼‰
â”œâ”€â”€ userId (FK â†’ users)
â”œâ”€â”€ model, tokens, cost
â””â”€â”€ createdAt
```

**ç´¢å¼•ä¼˜åŒ–**:
- `records`: `(userId, timestamp DESC)`
- `diaries`: `(userId, date DESC)`, `(userId, isPinned, createdAt DESC)`
- `media`: `(userId, createdAt DESC)`

---

## ğŸ”Œ API ç«¯ç‚¹æ€»è§ˆ

### è®¤è¯ API (`/api/v1/auth`)
```
POST   /register         # æ³¨å†Œ
POST   /login            # ç™»å½•
POST   /logout           # ç™»å‡º
GET    /me               # è·å–å½“å‰ç”¨æˆ·
PUT    /profile          # æ›´æ–°ä¸ªäººèµ„æ–™
PUT    /password         # ä¿®æ”¹å¯†ç 
```

### ç”Ÿæ´»è®°å½• API (`/api/v1/records`)
```
GET    /                 # è·å–åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰
GET    /:id              # è·å–å•æ¡
POST   /                 # åˆ›å»º
PUT    /:id              # æ›´æ–°
DELETE /:id              # åˆ é™¤
POST   /batch            # æ‰¹é‡åˆ›å»ºï¼ˆè¿ç§»ï¼‰
GET    /filter/date-range # æ—¥æœŸèŒƒå›´æŸ¥è¯¢
```

### AIæ—¥è®° API (`/api/v1/diaries`)
```
GET    /                 # è·å–åˆ—è¡¨
GET    /:id              # è·å–å•ç¯‡
GET    /date/:date       # æŒ‰æ—¥æœŸè·å–
POST   /                 # åˆ›å»º/ä¿å­˜
PUT    /:id              # æ›´æ–°
DELETE /:id              # åˆ é™¤ï¼ˆè½¯åˆ é™¤ï¼‰
GET    /stats/summary    # ç»Ÿè®¡ä¿¡æ¯
```

### åª’ä½“ API (`/api/v1/media`)
```
POST   /upload           # ä¸Šä¼ æ–‡ä»¶
GET    /:id              # è·å–ä¿¡æ¯
DELETE /:id              # åˆ é™¤
GET    /presigned-url/upload   # é¢„ç­¾åä¸Šä¼ 
GET    /presigned-url/download/:id # é¢„ç­¾åä¸‹è½½
```

### åŒæ­¥ API (`/api/v1/sync`)
```
POST   /pull             # æ‹‰å–æœåŠ¡å™¨æ•°æ®
POST   /push             # æ¨é€å®¢æˆ·ç«¯æ•°æ®
GET    /status           # åŒæ­¥çŠ¶æ€
POST   /resolve-conflict # è§£å†³å†²çª
```

### AIä»£ç† API (`/api/v1/ai`)
```
POST   /chat             # AIèŠå¤©ï¼ˆä»£ç†ï¼‰
POST   /analyze          # æ•°æ®åˆ†æ
GET    /usage            # ä½¿ç”¨ç»Ÿè®¡
```

**æ€»è®¡**: 30+ ä¸ª API ç«¯ç‚¹

---

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### æ¨èé…ç½®ï¼ˆæœ€ä½æˆæœ¬ï¼‰

| æœåŠ¡ | å¹³å° | é…ç½® | æˆæœ¬ |
|------|------|------|------|
| **åç«¯æœåŠ¡** | Railway | Hobby Plan | $5/æœˆ |
| **æ•°æ®åº“** | Neon | 512MB (Free) | $0 |
| **å¯¹è±¡å­˜å‚¨** | Cloudflare R2 | 10GB (Free) | $0 |
| **Redis** | Upstash | 10Kå‘½ä»¤/å¤© (Free) | $0 |
| **æ€»è®¡** | | | **$5/æœˆ** |

### æ”¯æŒçš„éƒ¨ç½²å¹³å°

- âœ… **Railway** (æ¨è)
- âœ… **Render** (å…è´¹å±‚å¯ç”¨)
- âœ… **Vercel** (Serverless)
- âœ… **Fly.io**
- âœ… AWS / GCP / Azure

è¯¦è§: [backend/docs/DEPLOYMENT.md](./backend/docs/DEPLOYMENT.md)

---

## ğŸ“– æ–‡æ¡£æ¸…å•

| æ–‡æ¡£ | è¯´æ˜ | é¡µæ•° |
|------|------|------|
| `BACKEND_ARCHITECTURE.md` | å®Œæ•´æ¶æ„è®¾è®¡ã€æŠ€æœ¯é€‰å‹ã€æœ€ä½³å®è·µ | 37é¡µ |
| `QUICK_START.md` | 5åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨æŒ‡å— | 10é¡µ |
| `backend/README.md` | åç«¯é¡¹ç›® READMEã€API æ–‡æ¡£ | 15é¡µ |
| `backend/docs/DEPLOYMENT.md` | è¯¦ç»†éƒ¨ç½²æŒ‡å—ï¼ˆRailway/Render/Vercelï¼‰ | 20é¡µ |
| `BACKEND_IMPLEMENTATION_SUMMARY.md` | æœ¬æ–‡æ¡£ï¼ˆæ€»ç»“ï¼‰ | 8é¡µ |

**æ€»è®¡**: 90+ é¡µå®Œæ•´æ–‡æ¡£

---

## ğŸ› ï¸ å¼€å‘å·¥å…·

### NPM è„šæœ¬

```json
{
  "dev": "tsx watch src/server.ts",           // å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
  "build": "tsc && tsc-alias",                // æ„å»ºç”Ÿäº§ç‰ˆæœ¬
  "start": "node dist/server.js",             // ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
  "prisma:generate": "prisma generate",       // ç”Ÿæˆ Prisma Client
  "prisma:migrate": "prisma migrate dev",     // è¿è¡Œæ•°æ®åº“è¿ç§»
  "prisma:studio": "prisma studio",           // æ•°æ®åº“å¯è§†åŒ–
  "prisma:deploy": "prisma migrate deploy",   // ç”Ÿäº§ç¯å¢ƒè¿ç§»
  "test": "vitest",                           // è¿è¡Œæµ‹è¯•
  "lint": "eslint src --ext .ts",             // ä»£ç æ£€æŸ¥
  "format": "prettier --write \"src/**/*.ts\""// ä»£ç æ ¼å¼åŒ–
}
```

### æ•°æ®è¿ç§»å·¥å…·

**å‰ç«¯å¯¼å‡ºè„šæœ¬** (`tools/migrate-to-backend.ts`):
- ä» IndexedDB å¯¼å‡ºæ‰€æœ‰æ•°æ®
- ç”Ÿæˆ JSON æ–‡ä»¶
- æ”¯æŒ Recordsã€Diariesã€Chat Sessions

**åç«¯å¯¼å…¥è„šæœ¬**:
```bash
npx tsx tools/migrate-to-backend.ts <userId> <exportFile.json>
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ä»£ç ç»“æ„
- âœ… åˆ†å±‚æ¶æ„ï¼ˆè·¯ç”± â†’ æ§åˆ¶å™¨ â†’ æœåŠ¡ â†’ æ•°æ®åº“ï¼‰
- âœ… å•ä¸€èŒè´£åŸåˆ™
- âœ… ä¾èµ–æ³¨å…¥
- âœ… ç±»å‹å®‰å…¨ï¼ˆTypeScriptï¼‰

### 2. å®‰å…¨
- âœ… JWT è®¤è¯
- âœ… è¾“å…¥éªŒè¯ï¼ˆZod Schemaï¼‰
- âœ… é™æµä¿æŠ¤ï¼ˆRedisï¼‰
- âœ… HTTPS Only
- âœ… ç¯å¢ƒå˜é‡ç®¡ç†

### 3. æ€§èƒ½
- âœ… æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- âœ… åˆ†é¡µæŸ¥è¯¢ï¼ˆé¿å…å…¨é‡åŠ è½½ï¼‰
- âœ… Redis ç¼“å­˜
- âœ… CDN åŠ é€Ÿï¼ˆCloudflare R2ï¼‰
- âœ… å‹ç¼©å“åº”ï¼ˆcompressionï¼‰

### 4. å¯ç»´æŠ¤æ€§
- âœ… æ¸…æ™°çš„ç›®å½•ç»“æ„
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- âœ… ç»“æ„åŒ–æ—¥å¿—
- âœ… API ç‰ˆæœ¬æ§åˆ¶ï¼ˆ/v1ï¼‰
- âœ… è¯¦ç»†æ³¨é‡Šå’Œæ–‡æ¡£

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### å•å…ƒæµ‹è¯•ï¼ˆæœªå®ç°ï¼Œå»ºè®®æ·»åŠ ï¼‰

```typescript
// tests/controllers/auth.controller.test.ts
import { describe, it, expect } from 'vitest'
import { register } from '@/controllers/auth.controller'

describe('AuthController', () => {
  it('should register a new user', async () => {
    const req = { body: { email: 'test@example.com', password: 'test123' } }
    const res = { status: jest.fn(), json: jest.fn() }
    
    await register(req, res, jest.fn())
    
    expect(res.status).toHaveBeenCalledWith(201)
  })
})
```

### é›†æˆæµ‹è¯•

```bash
# ä½¿ç”¨ Supertest
npm install --save-dev supertest @types/supertest
```

### API æµ‹è¯•

- **Postman Collection**: å¯¼å‡ºæ‰€æœ‰ API ç«¯ç‚¹
- **è‡ªåŠ¨åŒ–æµ‹è¯•**: GitHub Actions CI/CD

---

## ğŸ”„ æŒç»­æ”¹è¿›å»ºè®®

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰

1. âœ… è¡¥å……å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
2. âœ… å®ç° AI ä»£ç†åŠŸèƒ½ï¼ˆéšè— API Keyï¼‰
3. âœ… å®Œå–„æ•°æ®åŒæ­¥å†²çªè§£å†³
4. âœ… æ·»åŠ  WebSocket å®æ—¶åŒæ­¥
5. âœ… å®ç° Google/GitHub OAuth ç™»å½•

### ä¸­æœŸï¼ˆ1-2æœˆï¼‰

1. âœ… å®ç°ä¼šå‘˜ä»˜è´¹ç³»ç»Ÿï¼ˆStripe é›†æˆï¼‰
2. âœ… æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½ï¼ˆPDF/Markdownï¼‰
3. âœ… å®ç°å…¨æ–‡æœç´¢ï¼ˆPostgreSQL FTSï¼‰
4. âœ… æ·»åŠ å›¾ç‰‡å‹ç¼©å’Œ WebP è½¬æ¢
5. âœ… æ€§èƒ½ç›‘æ§ï¼ˆSentry/DataDogï¼‰

### é•¿æœŸï¼ˆ3-6æœˆï¼‰

1. âœ… å¾®æœåŠ¡æ‹†åˆ†ï¼ˆåª’ä½“æœåŠ¡ç‹¬ç«‹ï¼‰
2. âœ… GraphQL APIï¼ˆæ›¿ä»£ RESTï¼‰
3. âœ… æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¼‚æ­¥å¤„ç†ä»»åŠ¡ï¼‰
4. âœ… å¤šè¯­è¨€æ”¯æŒï¼ˆi18nï¼‰
5. âœ… ç§»åŠ¨ç«¯ä¸“ç”¨ API ä¼˜åŒ–

---

## ğŸ“ˆ æ‰©å±•æ€§è®¾è®¡

### æ”¯æŒçš„ç”¨æˆ·è§„æ¨¡

| è§„æ¨¡ | ç”¨æˆ·æ•° | QPS | æ•°æ®åº“ | å­˜å‚¨ | æˆæœ¬/æœˆ |
|------|--------|-----|--------|------|---------|
| **å°å‹** | 100 | 10 | Neon 512MB | 10GB | $5 |
| **ä¸­å‹** | 1,000 | 100 | Neon 3GB | 100GB | $50 |
| **å¤§å‹** | 10,000 | 1,000 | Neon 10GB | 1TB | $300 |
| **è¶…å¤§å‹** | 100,000 | 10,000 | AWS RDS | 10TB | $2,000+ |

**æ¨ªå‘æ‰©å±•**:
- æ•°æ®åº“è¯»å†™åˆ†ç¦»
- Redis Cluster
- å¤šåŒºåŸŸéƒ¨ç½²ï¼ˆå…¨çƒ CDNï¼‰
- è´Ÿè½½å‡è¡¡

---

## ğŸ“ å­¦ä¹ è·¯å¾„

å¦‚æœä½ å¯¹åç«¯å¼€å‘ä¸ç†Ÿæ‚‰ï¼Œå»ºè®®å­¦ä¹ ï¼š

1. **Node.js åŸºç¡€** (2-3å¤©)
   - å¼‚æ­¥ç¼–ç¨‹ï¼ˆPromise/async-awaitï¼‰
   - æ¨¡å—ç³»ç»Ÿï¼ˆCommonJS/ESMï¼‰
   - äº‹ä»¶å¾ªç¯

2. **Express æ¡†æ¶** (2-3å¤©)
   - è·¯ç”±å’Œä¸­é—´ä»¶
   - è¯·æ±‚å“åº”å¤„ç†
   - é”™è¯¯å¤„ç†

3. **PostgreSQL å’Œ Prisma** (3-5å¤©)
   - SQL åŸºç¡€
   - Prisma Schema è®¾è®¡
   - æŸ¥è¯¢ä¼˜åŒ–

4. **JWT è®¤è¯** (1-2å¤©)
   - Token ç”Ÿæˆå’ŒéªŒè¯
   - ä¸­é—´ä»¶å®ç°

5. **Cloudflare R2** (1å¤©)
   - S3 API ä½¿ç”¨
   - æ–‡ä»¶ä¸Šä¼ ä¸‹è½½

**æ€»æ—¶é—´**: 10-15 å¤©å¯æŒæ¡æ ¸å¿ƒæŠ€èƒ½

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. **åˆ›å»ºè·¯ç”±** (`src/routes/xxx.routes.ts`)
2. **åˆ›å»ºæ§åˆ¶å™¨** (`src/controllers/xxx.controller.ts`)
3. **æ·»åŠ éªŒè¯ Schema** (Zod)
4. **æ›´æ–°æ•°æ®åº“ Schema** (å¦‚éœ€è¦)
5. **åœ¨ `server.ts` æ³¨å†Œè·¯ç”±**
6. **ç¼–å†™æ–‡æ¡£å’Œæµ‹è¯•**

### ä»£ç è§„èŒƒ

- TypeScript strict mode
- ESLint + Prettier
- æäº¤å‰è¿è¡Œ `npm run lint`
- ä½¿ç”¨è¯­ä¹‰åŒ–æäº¤ä¿¡æ¯ï¼ˆConventional Commitsï¼‰

---

## ğŸ“ è”ç³»ä¸æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼š

1. ğŸ“– æŸ¥çœ‹æ–‡æ¡£: [BACKEND_ARCHITECTURE.md](./BACKEND_ARCHITECTURE.md)
2. ğŸš€ å¿«é€Ÿå¼€å§‹: [QUICK_START.md](./QUICK_START.md)
3. ğŸ› æäº¤ Issue: GitHub Issues
4. ğŸ’¬ è®¨è®º: GitHub Discussions

---

## ğŸ‰ æ€»ç»“

ä½ ç°åœ¨æ‹¥æœ‰ï¼š

- âœ… **å®Œæ•´çš„åç«¯æ¶æ„è®¾è®¡** (37é¡µæŠ€æœ¯æ–‡æ¡£)
- âœ… **ç”Ÿäº§çº§ä»£ç å®ç°** (30+ æ–‡ä»¶, 5000+ è¡Œä»£ç )
- âœ… **7å¼ æ•°æ®åº“è¡¨è®¾è®¡** (Prisma Schema)
- âœ… **30+ API ç«¯ç‚¹** (RESTful API)
- âœ… **å®‰å…¨å’Œæ€§èƒ½ä¼˜åŒ–** (JWT + é™æµ + ç¼“å­˜)
- âœ… **è¯¦ç»†éƒ¨ç½²æŒ‡å—** (Railway/Render/Vercel)
- âœ… **æ•°æ®è¿ç§»å·¥å…·** (IndexedDB â†’ PostgreSQL)
- âœ… **5åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨** (å¼€ç®±å³ç”¨)

**æˆæœ¬**: åˆæœŸ $5/æœˆï¼Œå¯æ‰©å±•åˆ°ä¸‡äººè§„æ¨¡

**ä¸‹ä¸€æ­¥**: æŒ‰ç…§ [QUICK_START.md](./QUICK_START.md) å¯åŠ¨æœåŠ¡å™¨ï¼Œå¼€å§‹å¼€å‘ï¼

---

**ç¥ä½ å¼€å‘é¡ºåˆ©ï¼ğŸš€**

æœ‰ä»»ä½•é—®é¢˜éšæ—¶è”ç³»æˆ‘ã€‚

